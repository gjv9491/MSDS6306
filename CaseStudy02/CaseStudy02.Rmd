---
title: "Case Study 02"
author: "contributed by Ramesh and gino"
date: "December 08, 2016"
output: 
  html_document:
    keep_md: true
---
## Introduction

Case Study 02, final case study.    

* installation and loading of necessary packages              
* R version        
<br>

```{r setup, include=TRUE, message=FALSE, echo=TRUE}
knitr::opts_chunk$set(echo = TRUE)
require(tseries)
sessionInfo()
```

<br>
<br>

### Question 1                                                        
##### Create the X matrix and print it from SAS, R, and Python.                            
<br>

#### SAS Code


```{sas sasq01, eval=FALSE, cache=TRUE, echo=TRUE}
data mylib.Xmatrix;
input x0 x1 x2 x3;
datalines;
4 5 1 2
1 0 3 5
2 1 8 2
;
run;
quit;

Proc IML;
use mylib.Xmatrix;
read all;
x = x0 || x1 || x2 || x3;
print x;
run;
quit;
```          
![alt text](https://github.com/gjv9491/MSDS6306/blob/casestudy02/CaseStudy02/CaseStudy02_files/figure-html/SASQ01-1.png "SAS output")
<br>

#### R Code


```{r rq01, eval=TRUE, cache=TRUE, echo=TRUE}
new_vector <- c(4,5,1,2,1,0,3,5,2,1,8,2)
X <- matrix(new_vector, ncol=4, nrow=3, byrow=TRUE)
X
```                                 
<br>

#### Python Code


```{python pyq01, eval=FALSE, cache=TRUE, echo=TRUE}
import numpy as np

new_array = np.array([4,5,1,2,1,0,3,5,2,1,8,2])
new_matrix = np.matrix(new_array)
X = new_matrix.reshape(3,4)
print(X)
```                                     
![alt text](https://github.com/gjv9491/MSDS6306/blob/casestudy02/CaseStudy02/CaseStudy02_files/figure-html/PYTHONQ01-1.png "Python output")
<br>

### Question 2                                                        
##### Please do the following with your assigned stock. "ADP" 
<br>

#### Download "ADP" data.
```{r radp01, eval=TRUE, cache=TRUE, echo=TRUE}
ADP_data <- get.hist.quote('ADP',quote="Close")
``` 
<br>

#### Calculate log returns.                        
```{r radp02, eval=TRUE, cache=TRUE, echo=TRUE}
ADP_return <- log(lag(ADP_data)) - log(ADP_data)
ADP_volatility <- sd(ADP_return) * sqrt(250) * 100
``` 
<br>

#### Calculate volatility measure.
```{r radp03, eval=TRUE, cache=TRUE, echo=TRUE}
getVol <- function(d, log_returns){
  var = 0
  lam = 0
  varlist <- c()

  for (r in log_returns) {
    lam = lam*(1 - 1/d) + 1
    var = (1 - 1/lam)*var + (1/lam)*r^2
    varlist <- c(varlist, var)
  }
  sqrt(varlist)
}
``` 
<br>

#### Calculate volatility over entire length of series for various three different decay factors.
```{r radp04, eval=TRUE, cache=TRUE, echo=TRUE}
volest <- getVol(10,ADP_return)
volest2 <- getVol(30,ADP_return)
volest3 <- getVol(100,ADP_return)

```                    
<br>                

#### Plot the results, overlaying the volatility curves on the data, just as was done in the S&P example.              
```{r radp05, eval=TRUE, cache=FALSE, echo=TRUE}
plot(volest, type="l", col="green", main="Volatility curves for ADP stock", ylab = "Volitality Estimate")
lines(volest2,type="l",col="red")
lines(volest3, type = "l", col="blue")
```                    
<br>  
<br>